<div class="audit-package-container">
    <!-- Header with project information -->
    <div class="header-section">
        <h1>{{ projectInfo?.opportunityName || 'Loading Project...' }}</h1>
        <div class="project-info">
            <div class="info-item">
                <div class="info-label">Audit Code</div>
                <div class="info-value">{{ projectInfo?.auditCode }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Stage</div>
                <div class="info-value">{{ getStageDisplayName() }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Team Leader</div>
                <div class="info-value">{{ projectInfo?.teamLeader }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Audit Team</div>
                <div class="info-value">{{ projectInfo?.auditTeam }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Status</div>
                <div class="info-value">{{ projectInfo?.status }}</div>
            </div>
        </div>
    </div>

    <!-- Actions: Download template & Upload -->
    <div class="action-section">
        <h3>
            <span class="section-icon">D</span> Download Template
            <span class="document-type-badge">{{ getDocumentTypeLabel() }}</span>
        </h3>
        <button class="btn btn-primary" [disabled]="isLoading" (click)="downloadTemplate()">
            Generate & Download {{ getDocumentTypeLabel() }}
        </button>
    </div>

    <div class="action-section">
        <h3>
            <span class="section-icon">U</span> Upload Modified Document
        </h3>
        <div class="file-input-group">
            <label for="certificateFile">Select File</label>
            <input type="file" id="certificateFile" (change)="onFileSelected($event)">
            <div class="help-text">Allowed: .docx, .doc, .pdf | Max size: 10MB</div>
        </div>
        <button class="btn btn-success" [disabled]="isLoading || !selectedFile" (click)="uploadFile()">
            Upload
        </button>
        <button class="btn btn-info" [disabled]="!uploadedFileName" (click)="downloadUploadedFile()">
            Download Uploaded File
        </button>
        <div *ngIf="uploadedFileName" class="help-text">
            Uploaded File: <strong>{{ uploadedFileName }}</strong>
        </div>
    </div>

    <!-- User activity history -->
    <div class="history-section">
        <h3>
            <span class="section-icon">H</span> Activity History
            <button class="btn btn-secondary" (click)="toggleHistory()">
                {{ showHistory ? 'Hide' : 'Show' }}
            </button>
        </h3>
        <div *ngIf="showHistory" class="history-content">
            <div *ngIf="userHistory.length === 0" class="no-history">
                No activities yet.
            </div>
            <div class="history-list">
                <div *ngFor="let activity of userHistory" class="history-item">
                    <div class="activity-info">
            <span class="activity-type" [ngClass]="'type-' + activity.activityType.toLowerCase()">
              {{ activity.activityType }}
            </span>
                        <span class="activity-file">{{ activity.fileName }}</span>
                        <span class="activity-date">{{ formatDate(activity.timestamp) }}</span>
                    </div>
                    <div class="activity-description">{{ activity.description }}</div>
                </div>
            </div>
        </div>
    </div>

    <button class="btn btn-back" (click)="goBack()">Back to Dashboard</button>

</div>
